include console.inc

COMMENT ~

 СТУДЕНТ Аксенов Павел     группа 110
 САМОСТОЯТЕЛЬНАЯ РАБОТА 11

 ЗАДАЧА_2 (максимально 30 очков)
 
 Описать процедуру Assign(X) CО СТАНДАРТНЫМИ СОГЛАШЕНИЯМИ О СВЯЗЯХ, которая 
 принимает на вход адрес двойного слова (без знака) и преобразует это двойное
 слово по следующему правилу: 
 Х := 40 * (Х div 64 + Х mod 8) - 17
 
 ВАЖНОЕ ТРЕБОВАНИЕ: в решении ЗАПРЕЩЕНО ИСПОЛЬЗОВАТЬ команды сложения, 
 вычитания, умножения и деления.
 ПОДСКАЗКА: использовать команды shr, shl, and, lea.

 Выписать ОБРАЩЕНИЕ К ЭТОЙ ПРОЦЕДУРЕ для переменной Y, описание которой
 дано в секции данных этой программы, а после  обращения к процедуре
 - вывести НОВОЕ ЗНАЧЕНИЕ переменной Y (вывод нужно осуществлять из основной 
 программы). При правильной работе процедуры Assign должно быть напечатано 
 число 370495

~

.data
T   db " Аксенов Павел   Задача_2 (с-р 11)",0		
Y   dd 987654  ; б/зн

.code
assign proc
    push EBP
    mov EBP, ESP
    push EAX
    push EBX
    push ECX
    
    mov EAX, dword ptr [EBP+8]
    mov EBX, [EAX]
    mov ECX, [EAX]
    shr EBX, 6
    and ECX, 111b
    lea EBX, [EBX+ECX]
    lea EBX, [8*EBX]
    mov ECX, EBX
    lea EBX, [4*ECX+EBX-17]
    mov ECX, [EBP+8]
    mov [ECX], EBX
    pop ECX
    pop EBX
    pop EAX
    pop EBP
    ret 4
assign endp
    
Start:
;	здесь размещаются команды программы
    ConsoleTitle offset T
    lea EAX, Y	
    push EAX
    call assign

;   печать нового значения переменной Y после вызова процедуры Assign:
    outwordln Y,,"Y = "   

    pause						; нужно при сдаче по e-mail
    exit						
    end Start
